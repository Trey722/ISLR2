"0","library(ISLR2)"
"0",""
"0","log_reg <-  glm(default ~ income+balance, data=Default, family = ""binomial"")"
"0",""
"0",""
"0",""
"0",""
"0",""
"0","train_proportion <- 0.5  "
"0",""
"0","vald_error <- numeric(3)"
"0",""
"0","for (i in 1:3) {"
"0","# Generate a random sample of indexes"
"0","train_index <- sample(1:nrow(Default), size = train_proportion * nrow(Default))"
"0",""
"0","# Create training and testing datasets"
"0","train <- Default[train_index, ]"
"0","test <- Default[-train_index, ]"
"0",""
"0","train_log_reg <- glm(default ~ income + balance, data = train, family = ""binomial"")"
"0",""
"0","test$predicted_probs <- predict(log_reg, newdata = test, type = ""response"")"
"0",""
"0","test$predicted_class <- ifelse(test$predicted_probs > 0.5, ""Yes"", ""No"")"
"0",""
"0","confusion_matrix <- table(test$default, test$predicted_class)"
"0",""
"0","misclassified <- sum(confusion_matrix) - sum(diag(confusion_matrix))"
"0","validation_error <- misclassified / sum(confusion_matrix)"
"0",""
"0","vald_error[i] <- validation_error"
"0",""
"0","}"
"0",""
"0","mean(vald_error)"
"1","[1]"
"1"," 0.02646667"
"1","
"
"0","# The test error looks to be quite low. "
"0",""
"0",""
"0","model_with_student <- glm(default ~ income + balance + student, data = train, family = ""binomial"")"
"0",""
"0",""
"0","for (i in 1:10) {"
"0","# Generate a random sample of indexes"
"0","train_index <- sample(1:nrow(Default), size = train_proportion * nrow(Default))"
"0",""
"0","# Create training and testing datasets"
"0","train <- Default[train_index, ]"
"0","test <- Default[-train_index, ]"
"0",""
"0","train_log_reg <- glm(default ~ income + balance + student, data = train, family = ""binomial"")"
"0",""
"0","test$predicted_probs <- predict(log_reg, newdata = test, type = ""response"")"
"0",""
"0","test$predicted_class <- ifelse(test$predicted_probs > 0.5, ""Yes"", ""No"")"
"0",""
"0","confusion_matrix <- table(test$default, test$predicted_class)"
"0",""
"0","misclassified <- sum(confusion_matrix) - sum(diag(confusion_matrix))"
"0","validation_error <- misclassified / sum(confusion_matrix)"
"0",""
"0","vald_error[i] <- validation_error"
"0",""
"0","}"
"0",""
"0","mean(vald_error)"
"1","[1]"
"1"," 0.02648"
"1","
"
"0","# Adding student doesm't seem to change vald_error. "
