"0",""
"0",""
"0","# A."
"0","log_model <- glm(Direction ~ Lag1 + Lag2, data=Weekly, family = ""binomial"")"
"0",""
"0","summary(log_model)"
"1","
Call:
"
"1",""
"1","glm(formula = Direction ~ Lag1 + Lag2, family = ""binomial"", data = Weekly)"
"1",""
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)"
"1","  0.22122"
"1","    0.06147"
"1","   3.599"
"1"," 0.000319"
"1"," ***"
"1","
Lag1       "
"1"," -0.03872"
"1","    0.02622"
"1","  -1.477"
"1"," 0.139672"
"1","    "
"1","
Lag2       "
"1","  0.06025"
"1","    0.02655"
"1","   2.270"
"1"," 0.023232"
"1"," *  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 1496.2  on 1088  degrees of freedom
"
"1",""
"1","Residual deviance: 1488.2  on 1086  degrees of freedom
"
"1","AIC: "
"1",""
"1","1494.2"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","4"
"1",""
"1","
"
"1","
"
"0","# B."
"0","log_model_minus_one <- glm(Direction ~ Lag1 + Lag2, data= Weekly[-1, ], family = ""binomial"")"
"0",""
"0",""
"0","#C."
"0","first_obs <- data.frame(Lag1 = Weekly$Lag1[1], Lag2 = Weekly$Lag2[1])"
"0",""
"0",""
"0",""
"0","predicted_prob <- predict(log_model_minus_one, newdata = first_obs, type = ""response"")"
"0",""
"0","predicted_class <- ifelse(predicted_prob > 0.5, ""Up"", ""Down"")"
"0",""
"0","actual_class <- Weekly$Direction[1]"
"0",""
"0","predicted_class"
"1","   1 "
"1","
"
"1","""Up"" "
"1","
"
"0"," Weekly$Direction[1]"
"1","[1]"
"1"," Down"
"1","
"
"1",""
"1","Levels: "
"1",""
"1","Down Up"
"1",""
"1","
"
"0"," "
"0"," # My moddel was correcrt"
"0"," errors <- numeric(nrow(Weekly))"
"0"," i <- -1"
"0","# D"
"0","for (i in 1:nrow(Weekly)) {"
"0","  # i. Fit a model using all but the ith observation"
"0","  model_loocv <- glm(Direction ~ Lag1 + Lag2, data = Weekly[-i, ], family = ""binomial"")"
"0","  "
"0","  # ii. Compute the posterior probability for the ith observation"
"0","  new_data <- data.frame(Lag1 = Weekly$Lag1[i], Lag2 = Weekly$Lag2[i])"
"0","  predicted_prob <- predict(model_loocv, newdata = new_data, type = ""response"")"
"0","  "
"0","  # iii. Predict whether the market moves up"
"0","  predicted_class <- ifelse(predicted_prob > 0.5, ""Up"", ""Down"")"
"0","  "
"0","  # iv. Determine if an error was made"
"0","  actual_class <- Weekly$Direction[i]"
"0","  errors[i] <- ifelse(predicted_class == actual_class, 0, 1)  # 0 if correct, 1 if error"
"0","}"
"0",""
"0","# E Calculate LOOCV error estimate"
"0","loocv_error <- mean(errors)"
"0","print(paste(""LOOCV Test Error Estimate:"", round(loocv_error, 4)))"
"1","[1]"
"1"," ""LOOCV Test Error Estimate: 0.45"""
"1","
"
